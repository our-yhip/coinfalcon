(this["webpackJsonp@cf/web"]=this["webpackJsonp@cf/web"]||[]).push([[25],{1386:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a(1),c=a.n(r),s=a(2),o=a(4),i=a(6),l=a(15),_=a(13),u=a(14),h=a(0),m=a.n(h),d=a(36),b=a(12),p=a.n(b),f=a(1271),C=a.n(f),v=a(24),g=a(186),x=a(10),y=a(19),O=a(29),E=a(8),j=a(5),k=a(170),w=a(578),N=a(21),U=a(580),S=a(712),T=a.n(S),A=function(e){var t=e.isActive,a=e.onlineCount,n=e.openChatbox,r=e.hideChatbox;return m.a.createElement("div",{className:p()("px-3",T.a.header),onClick:n},m.a.createElement(N.d,{type:"small",weight:"medium",className:p()("no-margin",T.a.header__left)},m.a.createElement(v.a.Inlined,{name:"message",size:"small",className:"mr-2"}),m.a.createElement("span",{className:T.a.status},Object(x.b)("chat.heading"),t&&m.a.createElement(N.f,{color:"success",weight:"medium",className:"d-block"},a," ",Object(x.b)("chat.people")))),m.a.createElement("div",{className:T.a.header__right},t?m.a.createElement(U.a,{text:Object(x.a)("chat.tooltip"),isVisibleOnHover:!0,className:T.a.minimize},m.a.createElement("span",{className:"hovered__ripple",onClick:r},m.a.createElement(v.a.Inlined,{name:"chevron-down",size:"small",color:"gray-light"}))):m.a.createElement(N.f,{color:"success",weight:"medium"},m.a.createElement("span",{className:p()("mr-1",T.a.active__dot)}),a)))},M=a(184),D=a(45),P=a(183),B={userInfoSet:O.X},K=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(_.a)(t)).call.apply(e,[this].concat(r)))).state={chatUsername:"",error:null,isLoading:!1},a.onStartChat=Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.isCorrect){e.next=2;break}return e.abrupt("return");case 2:return t=a.state.chatUsername,a.setState({isLoading:!0}),e.prev=4,e.next=7,E.a.get("chatbox").setUsername(t);case 7:a.props.userInfoSet({chatUsername:t}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),a.setState({error:e.t0.message,isLoading:!1});case 13:case"end":return e.stop()}}),e,null,[[4,10]])}))),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return m.a.createElement("div",{className:T.a.welcome},m.a.createElement("div",{className:"mb-2"},m.a.createElement(N.d,{weight:"medium",className:"no-margin mb-1"},Object(x.b)("chat.welcome.title")),m.a.createElement(N.f,{color:"dark-light"},Object(x.b)("chat.welcome.desc"))),m.a.createElement(M.a,{className:p()("mt-3 mb-4",T.a.username__input),placeholder:Object(x.a)("chat.placeholder.username"),value:this.state.chatUsername,onChange:function(t){return e.setState({chatUsername:t,error:""})},fullWidth:!0,onEnter:this.onStartChat}),m.a.createElement("div",{className:T.a.username__error},this.state.error&&m.a.createElement(P.a,{theme:"error",isCloseable:!0,onClose:function(){return e.setState({error:null})}},this.state.error)),m.a.createElement(D.a,{theme:"primary",className:T.a.start__chat,onClick:this.onStartChat,isLoading:this.state.isLoading,disabled:!this.isCorrect},Object(x.b)("common.action.startChat")))}},{key:"isCorrect",get:function(){var e=this.state.chatUsername,t=e.length,a=/^[a-zA-Z0-9]*$/.test(e);return t>3&&t<25&&a}}]),t}(m.a.Component),L=Object(d.b)(null,B)(K),z=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(_.a)(t)).call.apply(e,[this].concat(r)))).onDelete=function(){var e=Object(s.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.a.get("chatbox").deleteMessage(t);case 3:a.props.deleteChatMessage(t),e.next=8;break;case 6:e.prev=6,e.t0=e.catch(0);case 8:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.chat,r=t.isMyChat,c=t.isCurrentUserAdmin,s=t.onUsernameClick,o=a.id,i=a.chatUsername,l=a.body,_=a.admin,u=_?T.a.username__admin:T.a[Object(k.c)(i)],h=p()(T.a.chat_container,Object(n.a)({},T.a.my__chat,r));return m.a.createElement("div",{className:h},!r&&m.a.createElement("div",{className:p()(T.a.username,u),onClick:function(){return s(i)}},i,_&&m.a.createElement(v.a.Circled,{name:"check-white",color:"primary",className:T.a.admin__icon})),m.a.createElement("div",{className:T.a.chat},l),c&&m.a.createElement("div",{className:T.a.delete_container},m.a.createElement(v.a.Circled,{name:"trash",color:"red",className:T.a.delete__icon,onClick:function(){return e.onDelete(o)}})))}}]),t}(m.a.Component);z.defaultProps={isCurrentUserAdmin:!1};var I=z,H=function(e){var t=e.message,a=e.type,n=void 0===a?"error":a;return t?m.a.createElement("div",{className:p()(T.a.message,T.a["message--".concat(n)])},t):null};function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function X(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(a,!0).forEach((function(t){Object(n.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var J=300,V={sendChatMessage:O.U,deleteChatMessage:O.E},q=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(l.a)(this,(e=Object(_.a)(t)).call.apply(e,[this].concat(r)))).state={isActive:!1,chatText:"",error:null},a.contentEditableRef=m.a.createRef(),a.scrollBottomOnUpdate=!0,a.openChatbox=function(){return!a.state.isActive&&a.setState({isActive:!0})},a.hideChatbox=function(){return a.setState({isActive:!1})},a.onChatMessageChange=function(e){var t=e.nativeEvent.target,n=t.innerHTML;a.isEmpty(t.textContent||"")&&(n=""),a.setState({chatText:n.substring(0,J)})},a.onChatMessageSend=Object(s.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(k.d)(a.state.chatText.trim()),!a.isEmpty(t)){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,a.setState({chatText:""}),a.contentEditableRef.current.innerHTML="",e.next=8,a.props.sendChatMessage(t);case 8:e.next=16;break;case 10:return e.prev=10,e.t0=e.catch(3),a.setState({error:e.t0.message}),e.next=15,Object(j.f)(5e3);case 15:a.setState({error:null,chatText:t});case 16:case"end":return e.stop()}}),e,null,[[3,10]])}))),a.onUsernameClick=function(e){return a.setState({chatText:"".concat(a.state.chatText,"@").concat(e)})},a.handleScroll=function(e){var t=e.target;a.scrollBottomOnUpdate=t.clientHeight+t.scrollTop>=t.scrollHeight},a.onKeyDown=function(e){return Object(w.f)((function(){e.shiftKey?e.preventDefault():a.onChatMessageSend()}))(e)},a.isMyChat=function(e){return e===a.props.chatUsername},a.renderChatBody=function(){return m.a.createElement("div",{className:T.a.body},a.hasChatUsername?a.renderChatsView():m.a.createElement(L,null))},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){E.a.get("chatbox").subscribe()}},{key:"componentWillUnmount",value:function(){E.a.get("chatbox").unsubscribe()}},{key:"isEmpty",value:function(e){return!e.replace(/<br>/g,"").trim().length}},{key:"render",value:function(){var e=this.state.isActive;return m.a.createElement("div",{className:p()(T.a.container,Object(n.a)({},T.a.is__active,e))},m.a.createElement(A,{isActive:e,onlineCount:this.props.onlineCount,openChatbox:this.openChatbox,hideChatbox:this.hideChatbox}),this.renderChatBody())}},{key:"renderChatsView",value:function(){var e=this,t=this.state.error;return m.a.createElement(m.a.Fragment,null,m.a.createElement(g.a,{style:{height:310},scrollBottomOnUpdate:this.scrollBottomOnUpdate,onScroll:this.handleScroll},m.a.createElement("div",{className:T.a.chats},this.props.chats.map((function(t){return m.a.createElement(I,{chat:X({},t),key:t.id,onUsernameClick:e.onUsernameClick,isMyChat:e.isMyChat(t.chatUsername),isCurrentUserAdmin:e.props.isCurrentUserAdmin,deleteChatMessage:e.props.deleteChatMessage})})))),m.a.createElement("div",{className:T.a.input__box},t?m.a.createElement(H,{message:t}):this.renderChatInputBox()))}},{key:"renderChatInputBox",value:function(){var e=this.state.chatText;return m.a.createElement("div",{className:T.a.send__wrapper},m.a.createElement(C.a,{innerRef:this.contentEditableRef,html:Object(k.e)(e),onChange:this.onChatMessageChange,onKeyDown:this.onKeyDown}),!e.length&&m.a.createElement("div",{className:T.a.placeholder},Object(x.b)("chat.placeholder.message")),m.a.createElement(v.a.Circled,{name:"send",color:"gray-shy",iconColor:"gray",className:T.a.send,onClick:this.onChatMessageSend}))}},{key:"hasChatUsername",get:function(){var e=this.props.chatUsername;return e&&e.length}}]),t}(m.a.Component);t.default=Object(d.b)((function(e){return{chats:Object(y.E)(e),onlineCount:Object(y.X)(e),user:Object(y.bb)(e),chatUsername:Object(y.F)(e),isCurrentUserAdmin:Object(y.zb)(e)}}),V)(q)},578:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"f",(function(){return l})),a.d(t,"e",(function(){return _})),a.d(t,"g",(function(){return u}));var n=a(23),r=a(87),c=function(e){e.keyCode===r.c&&(e.preventDefault(),e.stopPropagation())},s=function(e){e.keyCode===r.a&&(e.preventDefault(),e.stopPropagation())},o=function(e){["-","+"].includes(e.key)&&(e.preventDefault(),e.stopPropagation())},i=function(e){var t=e.keyCode<=46,a=e.ctrlKey||e.metaKey;if(!t&&!a&&![r.a,r.b].includes(e.keyCode)){var n=Number(e.key);isNaN(n)&&(e.preventDefault(),e.stopPropagation())}},l=function(e){return function(t){t.keyCode===r.d&&e()}},_=function(e,t){return e.checkValidity()&&Object(n.k)(e.value,t)},u=function(e){return/^\.\d$/.test(e)?"0".concat(e):e}},580:function(e,t,a){"use strict";var n=a(7),r=a(0),c=a.n(r),s=a(12),o=a.n(s),i=a(581),l=a.n(i);t.a=function(e){var t=e.theme,a=void 0===t?"black":t,r=e.text,s=e.isVisibleOnHover,i=void 0!==s&&s,_=e.className,u=void 0===_?"":_,h=e.children;return c.a.createElement("div",{className:o()(l.a.tooltip,l.a[a],u,Object(n.a)({},l.a.on__hover,i))},c.a.createElement("span",{className:o()(l.a.inner)},r),c.a.createElement("div",null,h))}},581:function(e,t,a){e.exports={tooltip:"Tooltip_tooltip__1K7qB",on__hover:"Tooltip_on__hover__3WAi6",inner:"Tooltip_inner__17J5w text-weight--medium",black:"Tooltip_black__1ZEcO",primary:"Tooltip_primary__eKRXB",success:"Tooltip_success__2fQn_",error:"Tooltip_error__GinKx",warning:"Tooltip_warning__bFMX5",ghost:"Tooltip_ghost__7G1-r"}},712:function(e,t,a){e.exports={container:"Chatbox_container__3dbvl",is__active:"Chatbox_is__active__ww12l",header:"Chatbox_header__34shX",body:"Chatbox_body__BWc9n",header__left:"Chatbox_header__left__1zooa",status:"Chatbox_status__1BnKT",header__right:"Chatbox_header__right__11HCI",minimize:"Chatbox_minimize__3M0GA",active__dot:"Chatbox_active__dot__9Po8u",welcome:"Chatbox_welcome__2DIOV",username__input:"Chatbox_username__input__1E7Zq",username__error:"Chatbox_username__error__1kLap",start__chat:"Chatbox_start__chat__37KI8",chats:"Chatbox_chats__aOdJM",chat_container:"Chatbox_chat_container__kSbPA",delete_container:"Chatbox_delete_container__3tz6k",username:"Chatbox_username__1kXqB",username__admin:"Chatbox_username__admin__3B39C",username__brown:"Chatbox_username__brown__17mLh",username__blue:"Chatbox_username__blue__1scax",username__lavender:"Chatbox_username__lavender__KAm20",username__malibu:"Chatbox_username__malibu__37iTR",username__turquoise:"Chatbox_username__turquoise__2iQ-l",username__geraldine:"Chatbox_username__geraldine__e1xvN",admin__icon:"Chatbox_admin__icon__3pKpE",my__chat:"Chatbox_my__chat__9Ou3T",delete__icon:"Chatbox_delete__icon__79EQA",input__box:"Chatbox_input__box__3bJcg",chat__textarea:"Chatbox_chat__textarea__32trh",send__wrapper:"Chatbox_send__wrapper__2GaAo",placeholder:"Chatbox_placeholder__EPfTX",send:"Chatbox_send__1OFZb",message:"Chatbox_message__2DwJv","message--error":"Chatbox_message--error__3FZxL"}}}]);
//# sourceMappingURL=chatbox.030c2ce3.chunk.js.map